(self.webpackChunkproject_firefly=self.webpackChunkproject_firefly||[]).push([[6161],{15598:function(e,t,a){"use strict";a.r(t),a.d(t,{_frontmatter:function(){return o},default:function(){return d}});var n=a(22122),i=a(19756),r=(a(15007),a(64983)),s=a(99536),c=["components"],o={},p={_frontmatter:o},l=s.Z;function d(e){var t=e.components,a=(0,i.Z)(e,c);return(0,r.mdx)(l,(0,n.Z)({},p,a,{components:t,mdxType:"MDXLayout"}),(0,r.mdx)("h1",{id:"lesson-1-bootstrap-a-headless-firefly-app"},"Lesson 1: Bootstrap a Headless Firefly App"),(0,r.mdx)("p",null,"In order to create your barcode application, use the following command:"),(0,r.mdx)("pre",null,(0,r.mdx)("code",{parentName:"pre",className:"language-bash"},"aio app init my-barcode-app --no-extensions\n")),(0,r.mdx)("p",null,"We select the org, project and workspace for our app, and then be presented with a few options what you want your app to include (Serverless Actions, Web UI, CI/CD pipeline, I/O Events). Since we are building a headless app, we're only interested in using ",(0,r.mdx)("inlineCode",{parentName:"p"},"Actions: Deploy Runtime actions"),"."),(0,r.mdx)("p",null,(0,r.mdx)("span",{parentName:"p",className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"1070px"}},"\n      ",(0,r.mdx)("span",{parentName:"span",className:"gatsby-resp-image-background-image",style:{paddingBottom:"32.1875%",position:"relative",bottom:"0",left:"0",display:"block",transition:"opacity 0.5s 0.5s",pointerEvents:"none"}}),"\n  ",(0,r.mdx)("picture",{parentName:"span"},"\n          ",(0,r.mdx)("source",{parentName:"picture",srcSet:["/project-firefly/static/861a15cfd898005cbd7a0d71416f354f/cb523/cli1.webp 320w","/project-firefly/static/861a15cfd898005cbd7a0d71416f354f/797b9/cli1.webp 640w","/project-firefly/static/861a15cfd898005cbd7a0d71416f354f/91225/cli1.webp 1070w"],sizes:"(max-width: 1070px) 100vw, 1070px",type:"image/webp"}),"\n          ",(0,r.mdx)("source",{parentName:"picture",srcSet:["/project-firefly/static/861a15cfd898005cbd7a0d71416f354f/72799/cli1.png 320w","/project-firefly/static/861a15cfd898005cbd7a0d71416f354f/6af66/cli1.png 640w","/project-firefly/static/861a15cfd898005cbd7a0d71416f354f/121b3/cli1.png 1070w"],sizes:"(max-width: 1070px) 100vw, 1070px",type:"image/png"}),"\n          ",(0,r.mdx)("img",{parentName:"picture",className:"gatsby-resp-image-image",src:"/project-firefly/static/861a15cfd898005cbd7a0d71416f354f/121b3/cli1.png",alt:"cli1",title:"cli1",loading:"lazy",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",opacity:"0",transition:"opacity 0.5s",color:"inherit",boxShadow:"inset 0px 0px 0px 400px none",top:"0",left:"0"}}),"\n        "),"\n    ")),(0,r.mdx)("p",null,"The second question, the CLI asks us which experience cloud or experience platform apps you want to extend or build. In this case, we're going to choose ",(0,r.mdx)("inlineCode",{parentName:"p"},"Generic"),". "),(0,r.mdx)("p",null,(0,r.mdx)("span",{parentName:"p",className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"1280px"}},"\n      ",(0,r.mdx)("span",{parentName:"span",className:"gatsby-resp-image-background-image",style:{paddingBottom:"32.1875%",position:"relative",bottom:"0",left:"0",display:"block",transition:"opacity 0.5s 0.5s",pointerEvents:"none"}}),"\n  ",(0,r.mdx)("picture",{parentName:"span"},"\n          ",(0,r.mdx)("source",{parentName:"picture",srcSet:["/project-firefly/static/e992343d652a651b1bd0829c0c1ae20b/cb523/cli2.webp 320w","/project-firefly/static/e992343d652a651b1bd0829c0c1ae20b/797b9/cli2.webp 640w","/project-firefly/static/e992343d652a651b1bd0829c0c1ae20b/4b075/cli2.webp 1280w","/project-firefly/static/e992343d652a651b1bd0829c0c1ae20b/fff20/cli2.webp 1484w"],sizes:"(max-width: 1280px) 100vw, 1280px",type:"image/webp"}),"\n          ",(0,r.mdx)("source",{parentName:"picture",srcSet:["/project-firefly/static/e992343d652a651b1bd0829c0c1ae20b/72799/cli2.png 320w","/project-firefly/static/e992343d652a651b1bd0829c0c1ae20b/6af66/cli2.png 640w","/project-firefly/static/e992343d652a651b1bd0829c0c1ae20b/21b4d/cli2.png 1280w","/project-firefly/static/e992343d652a651b1bd0829c0c1ae20b/2a333/cli2.png 1484w"],sizes:"(max-width: 1280px) 100vw, 1280px",type:"image/png"}),"\n          ",(0,r.mdx)("img",{parentName:"picture",className:"gatsby-resp-image-image",src:"/project-firefly/static/e992343d652a651b1bd0829c0c1ae20b/21b4d/cli2.png",alt:"cli2",title:"cli2",loading:"lazy",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",opacity:"0",transition:"opacity 0.5s",color:"inherit",boxShadow:"inset 0px 0px 0px 400px none",top:"0",left:"0"}}),"\n        "),"\n    ")),(0,r.mdx)("p",null,"The third question, we'll specify the action name ",(0,r.mdx)("inlineCode",{parentName:"p"},"barcode"),"."),(0,r.mdx)("p",null,(0,r.mdx)("span",{parentName:"p",className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"1274px"}},"\n      ",(0,r.mdx)("span",{parentName:"span",className:"gatsby-resp-image-background-image",style:{paddingBottom:"30%",position:"relative",bottom:"0",left:"0",display:"block",transition:"opacity 0.5s 0.5s",pointerEvents:"none"}}),"\n  ",(0,r.mdx)("picture",{parentName:"span"},"\n          ",(0,r.mdx)("source",{parentName:"picture",srcSet:["/project-firefly/static/87ca9159fce254cd8c3add9cc42ef4ae/cb523/cli3.webp 320w","/project-firefly/static/87ca9159fce254cd8c3add9cc42ef4ae/797b9/cli3.webp 640w","/project-firefly/static/87ca9159fce254cd8c3add9cc42ef4ae/9a697/cli3.webp 1274w"],sizes:"(max-width: 1274px) 100vw, 1274px",type:"image/webp"}),"\n          ",(0,r.mdx)("source",{parentName:"picture",srcSet:["/project-firefly/static/87ca9159fce254cd8c3add9cc42ef4ae/72799/cli3.png 320w","/project-firefly/static/87ca9159fce254cd8c3add9cc42ef4ae/6af66/cli3.png 640w","/project-firefly/static/87ca9159fce254cd8c3add9cc42ef4ae/7960f/cli3.png 1274w"],sizes:"(max-width: 1274px) 100vw, 1274px",type:"image/png"}),"\n          ",(0,r.mdx)("img",{parentName:"picture",className:"gatsby-resp-image-image",src:"/project-firefly/static/87ca9159fce254cd8c3add9cc42ef4ae/7960f/cli3.png",alt:"cli3",title:"cli3",loading:"lazy",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",opacity:"0",transition:"opacity 0.5s",color:"inherit",boxShadow:"inset 0px 0px 0px 400px none",top:"0",left:"0"}}),"\n        "),"\n    ")),(0,r.mdx)("p",null,"What's happening here, from the command line a developer project is created that includes everything from the serverless actions, configuration files, tests etc. "),(0,r.mdx)("p",null,(0,r.mdx)("span",{parentName:"p",className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"1262px"}},"\n      ",(0,r.mdx)("span",{parentName:"span",className:"gatsby-resp-image-background-image",style:{paddingBottom:"61.875%",position:"relative",bottom:"0",left:"0",display:"block",transition:"opacity 0.5s 0.5s",pointerEvents:"none"}}),"\n  ",(0,r.mdx)("picture",{parentName:"span"},"\n          ",(0,r.mdx)("source",{parentName:"picture",srcSet:["/project-firefly/static/08ab0653d0b36c3811161250761722a0/cb523/cli4.webp 320w","/project-firefly/static/08ab0653d0b36c3811161250761722a0/797b9/cli4.webp 640w","/project-firefly/static/08ab0653d0b36c3811161250761722a0/7408f/cli4.webp 1262w"],sizes:"(max-width: 1262px) 100vw, 1262px",type:"image/webp"}),"\n          ",(0,r.mdx)("source",{parentName:"picture",srcSet:["/project-firefly/static/08ab0653d0b36c3811161250761722a0/72799/cli4.png 320w","/project-firefly/static/08ab0653d0b36c3811161250761722a0/6af66/cli4.png 640w","/project-firefly/static/08ab0653d0b36c3811161250761722a0/62da8/cli4.png 1262w"],sizes:"(max-width: 1262px) 100vw, 1262px",type:"image/png"}),"\n          ",(0,r.mdx)("img",{parentName:"picture",className:"gatsby-resp-image-image",src:"/project-firefly/static/08ab0653d0b36c3811161250761722a0/62da8/cli4.png",alt:"cli3",title:"cli3",loading:"lazy",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",opacity:"0",transition:"opacity 0.5s",color:"inherit",boxShadow:"inset 0px 0px 0px 400px none",top:"0",left:"0"}}),"\n        "),"\n    ")),(0,r.mdx)("p",null,"We didn't include the UI setup nor the CI/CD pipeline nor I/O Events. These topics will be covered in other codelabs. "),(0,r.mdx)("p",null,"For our barcode app, we'll start by modifying the following files:"),(0,r.mdx)("p",null,(0,r.mdx)("strong",{parentName:"p"},"app.config.yaml")," which contains all defined actions with their default parameters:"),(0,r.mdx)("pre",null,(0,r.mdx)("code",{parentName:"pre",className:"language-yaml"},"application:\n  actions: actions\n  web: web-src\n  runtimeManifest:\n    packages:\n      my-app:\n        license: Apache-2.0\n        actions:\n          generic:\n            function: actions/generic/index.js\n            web: 'yes'\n            runtime: 'nodejs:14'\n            inputs:\n              LOG_LEVEL: debug\n            annotations:\n              require-adobe-auth: true\n              final: true\n\n")),(0,r.mdx)("p",null,(0,r.mdx)("strong",{parentName:"p"},"package.json")," holds your app name, version and all dependencies that will be bundled when deploying the barcode action:"),(0,r.mdx)("pre",null,(0,r.mdx)("code",{parentName:"pre",className:"language-json"},'{\n  "name": "my-barcode-app",\n  "version": "0.0.1",\n  "dependencies": {\n    "@adobe/aio-sdk": "^2.1.0",\n    "node-fetch": "^2.6.0"\n  },\n  "devDependencies": {\n    "jest": "^24.9.0",\n    "@adobe/wskdebug": "^1.1.0"\n  },\n  "scripts": {\n    "test": "jest",\n    "e2e": "jest --collectCoverage=false --testRegex ./e2e"\n  }\n}\n')),(0,r.mdx)("p",null,(0,r.mdx)("strong",{parentName:"p"},".env")," should not be committed as this is where you'll store your Adobe I/O Runtime secrets (namespace and auth):"),(0,r.mdx)("pre",null,(0,r.mdx)("code",{parentName:"pre"},"# Specify your secrets here\n# This file should not be committed to source control\n\n## please provide your Adobe I/O Runtime credentials\n# AIO_RUNTIME_AUTH=\n# AIO_RUNTIME_NAMESPACE=\n")),(0,r.mdx)("p",null,(0,r.mdx)("strong",{parentName:"p"},"actions/barcode/index.js")," is the source code of your barcode action:       "),(0,r.mdx)("pre",null,(0,r.mdx)("code",{parentName:"pre",className:"language-javascript"},"/*\n* <license header>\n*/\n\n/**\n * This is a sample action showcasing how to access an external API\n */\n\nconst { Core } = require('@adobe/aio-sdk')\nconst fetch = require('node-fetch')\nconst { errorResponse, getBearerToken, stringParameters, checkMissingRequestInputs } = require('../utils')\n\n// main function that will be executed by Adobe I/O Runtime\nasync function main (params) {\n  // create a Logger\n  const logger = Core.Logger('main', { level: params.LOG_LEVEL || 'info' })\n\n  try {\n    // 'info' is the default level if not set\n    logger.info('Calling the main action')\n\n    // log parameters, only if params.LOG_LEVEL === 'debug'\n    logger.debug(stringParameters(params))\n\n    // check for missing request input parameters and headers\n    const requiredParams = [/* add required params */]\n    const errorMessage = checkMissingRequestInputs(params, requiredParams, ['Authorization'])\n    if (errorMessage) {\n      // return and log client errors\n      return errorResponse(400, errorMessage, logger)\n    }\n\n    // extract the user Bearer token from the input request parameters\n    const token = getBearerToken(params)\n\n    // replace this with the api you want to access\n    const apiEndpoint = 'https://adobeioruntime.net/api/v1/api-docs'\n\n    // fetch content from external api endpoint\n    const res = await fetch(apiEndpoint)\n    if (!res.ok) {\n      throw new Error('request to ' + apiEndpoint + ' failed with status code ' + res.status)\n    }\n    const content = await res.json()\n    logger.debug('fetch content = ' + JSON.stringify(content, null, 2))\n    const response = {\n      statusCode: 200,\n      body: content\n    }\n\n    // log the response status code\n    logger.info(`${response.statusCode}: successful request`)\n    return response\n  } catch (error) {\n    // log any server errors\n    logger.error(error)\n    // return with 500\n    return errorResponse(500, 'server error', logger)\n  }\n}\n\nexports.main = main\n")))}d.isMDXComponent=!0}}]);
//# sourceMappingURL=component---src-pages-resources-barcode-reader-bootstrap-md-341cd0c5c58270e0089f.js.map