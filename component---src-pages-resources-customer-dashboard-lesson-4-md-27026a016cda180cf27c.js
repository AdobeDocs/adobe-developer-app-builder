"use strict";(self.webpackChunkadobe_developer_app_builder=self.webpackChunkadobe_developer_app_builder||[]).push([[4086],{80729:function(e,a,n){n.r(a),n.d(a,{_frontmatter:function(){return s},default:function(){return m}});var o=n(87462),t=n(63366),r=(n(15007),n(64983)),i=n(91515),p=["components"],s={},l={_frontmatter:s},d=i.Z;function m(e){var a=e.components,n=(0,t.Z)(e,p);return(0,r.mdx)(d,(0,o.Z)({},l,n,{components:a,mdxType:"MDXLayout"}),(0,r.mdx)("h1",null,"Lesson 4: List All Customer Profiles on the UI"),(0,r.mdx)("p",null,"The app UI is powered by ",(0,r.mdx)("a",{parentName:"p",href:"https://react-spectrum.adobe.com/react-spectrum/index.html"},"React Spectrum")," by default. To learn more about React Spectrum, you're recommended to go through the ",(0,r.mdx)("a",{parentName:"p",href:"../todo-app/index.md"},"React Spectrum Codelab"),".  "),(0,r.mdx)("p",null,"In the ",(0,r.mdx)("a",{parentName:"p",href:"lesson3.md"},"previous lesson"),', customer profiles are only loaded to the frontend once you click the "Invoke" button. Now we want the profiles automatically loaded on the Home page when the page is ready, without any human interaction. '),(0,r.mdx)("p",null,"We will use the ",(0,r.mdx)("inlineCode",{parentName:"p"},"componentWillMount")," method to initiate loading profiles, and store the loaded data in ",(0,r.mdx)("inlineCode",{parentName:"p"},"profiles")," param of the component's state. We use ",(0,r.mdx)("inlineCode",{parentName:"p"},"<Flex>")," and ",(0,r.mdx)("inlineCode",{parentName:"p"},"<Grid>")," from React Spectrum to layout spectrum components on the page. Each entry of the customer profiles returned by the ",(0,r.mdx)("inlineCode",{parentName:"p"},"get-profiles")," action is displayed with first name, last name, and email of the customers. You can also apply some CSS styling in the ",(0,r.mdx)("inlineCode",{parentName:"p"},"index.css")," file to make it look nice. "),(0,r.mdx)("p",null,"Below is the complete code of ",(0,r.mdx)("inlineCode",{parentName:"p"},"Home.js"),"."),(0,r.mdx)("pre",null,(0,r.mdx)("code",{parentName:"pre",className:"language-javascript"},"import React from 'react'\nimport PropTypes from 'prop-types'\nimport { Flex, Grid, ProgressCircle, Heading, Text, View } from '@adobe/react-spectrum'\nimport actions from '../config.json'\nimport actionWebInvoke from '../utils'\n\nclass Home extends React.Component {\n  constructor (props) {\n    super(props)\n\n    this.state = {\n      actionResponseError: null,\n      actionInvokeInProgress: false,\n      profiles: null\n    }\n  }\n\n  async componentWillMount () {\n    this.setState({ actionInvokeInProgress: true })\n    \n    const headers = {}\n    const params = {}\n  \n    // set the authorization header and org from the ims props object\n    if (this.props.ims.token && !headers.authorization) {\n      headers.authorization = 'Bearer ' + this.props.ims.token\n    }\n    if (this.props.ims.org && !headers['x-gw-ims-org-id']) {\n      headers['x-gw-ims-org-id'] = this.props.ims.org\n    }\n    try {\n      const actionResponse = await actionWebInvoke(actions['get-profiles'], headers, params)\n      this.setState({ profiles: actionResponse.body.content, actionResponseError: null, actionInvokeInProgress: false })\n      console.log(`action response:`, actionResponse)\n    } catch (e) {\n      console.error(e)\n      this.setState({ profiles: null, actionResponseError: e.message, actionInvokeInProgress: false })\n    }\n  }\n\n  render () {\n    const profiles = this.state.profiles\n    console.log(`profiles object:`, profiles)\n    return (\n      <View>\n        <Heading level={1}>Customer Profiles</Heading>\n        <Flex UNSAFE_className='profiles'>\n          <ProgressCircle\n                UNSAFE_className='actions-invoke-progress'\n                aria-label='loading'\n                isIndeterminate\n                isHidden={ !this.state.actionInvokeInProgress }/>\n          { !!profiles &&\n            <Grid>\n              {profiles.map((profile, i) => {\n                return <Flex UNSAFE_className='profile'>Name: { profile['firstName'] } { profile['lastName'] } - Email: { profile['email'] } - Date of birth: { profile['birthDate'] }</Flex>\n              })}\n\n            </Grid>\n          }\n          { !profiles &&\n            <Text>No profiles!</Text>\n          }\n        </Flex>\n      </View>\n    )\n  }\n}\n\nHome.propTypes = {\n  ims: PropTypes.any\n}\n\nexport default Home\n")),(0,r.mdx)("p",null,(0,r.mdx)("em",{parentName:"p"},"Note: For simplicity of the lab, we only display the first page of the result. In a real environment, where there are hundreds of profiles, results are returned in batches, so you will need to handle pagination of data accordingly.")),(0,r.mdx)("p",null,"The ",(0,r.mdx)("inlineCode",{parentName:"p"},"Home")," component above requires the ",(0,r.mdx)("inlineCode",{parentName:"p"},"ims")," object in its ",(0,r.mdx)("inlineCode",{parentName:"p"},"propTypes")," to get the IMS context for calling the backend actions (including access token and org ID). This object is passed from the ",(0,r.mdx)("inlineCode",{parentName:"p"},"App")," component, so it has to be updated accordingly in the ",(0,r.mdx)("inlineCode",{parentName:"p"},"App.js")," file."),(0,r.mdx)("pre",null,(0,r.mdx)("code",{parentName:"pre",className:"language-javascript"},"<Home ims={props.ims} />\n")),(0,r.mdx)("p",null,"As your app is already running once you ran ",(0,r.mdx)("inlineCode",{parentName:"p"},"aio app run")," in the previous lesson, just refresh the webpage at ",(0,r.mdx)("a",{parentName:"p",href:"https://experience.adobe.com/?devMode=true#/apps/?localDevUrl=https://localhost:9080"},"https://experience.adobe.com/?devMode=true#/apps/?localDevUrl=https://localhost:9080")," to see the updated UI."),(0,r.mdx)("p",null,(0,r.mdx)("span",{parentName:"p",className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"1280px"}},"\n      ",(0,r.mdx)("span",{parentName:"span",className:"gatsby-resp-image-background-image",style:{paddingBottom:"47.8125%",position:"relative",bottom:"0",left:"0",display:"block"}}),"\n  ",(0,r.mdx)("picture",{parentName:"span"},"\n          ",(0,r.mdx)("source",{parentName:"picture",srcSet:["/adobe-developer-app-builder/static/cdd0358a9fdfa4e7ee8595a4e7f746bc/5530d/ui-profiles.webp 320w","/adobe-developer-app-builder/static/cdd0358a9fdfa4e7ee8595a4e7f746bc/0c8fb/ui-profiles.webp 640w","/adobe-developer-app-builder/static/cdd0358a9fdfa4e7ee8595a4e7f746bc/94b1e/ui-profiles.webp 1280w","/adobe-developer-app-builder/static/cdd0358a9fdfa4e7ee8595a4e7f746bc/0b34d/ui-profiles.webp 1920w","/adobe-developer-app-builder/static/cdd0358a9fdfa4e7ee8595a4e7f746bc/c8b27/ui-profiles.webp 1922w"],sizes:"(max-width: 1280px) 100vw, 1280px",type:"image/webp"}),"\n          ",(0,r.mdx)("source",{parentName:"picture",srcSet:["/adobe-developer-app-builder/static/cdd0358a9fdfa4e7ee8595a4e7f746bc/dd4a7/ui-profiles.png 320w","/adobe-developer-app-builder/static/cdd0358a9fdfa4e7ee8595a4e7f746bc/0f09e/ui-profiles.png 640w","/adobe-developer-app-builder/static/cdd0358a9fdfa4e7ee8595a4e7f746bc/bbbf7/ui-profiles.png 1280w","/adobe-developer-app-builder/static/cdd0358a9fdfa4e7ee8595a4e7f746bc/ac7a9/ui-profiles.png 1920w","/adobe-developer-app-builder/static/cdd0358a9fdfa4e7ee8595a4e7f746bc/e05f4/ui-profiles.png 1922w"],sizes:"(max-width: 1280px) 100vw, 1280px",type:"image/png"}),"\n          ",(0,r.mdx)("img",{parentName:"picture",className:"gatsby-resp-image-image",src:"/adobe-developer-app-builder/static/cdd0358a9fdfa4e7ee8595a4e7f746bc/bbbf7/ui-profiles.png",alt:"ui-profiles",title:"ui-profiles",loading:"lazy",decoding:"async",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",top:"0",left:"0"}}),"\n        "),"\n    ")))}m.isMDXComponent=!0}}]);
//# sourceMappingURL=component---src-pages-resources-customer-dashboard-lesson-4-md-27026a016cda180cf27c.js.map